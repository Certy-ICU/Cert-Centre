"use strict";var Ht=Object.defineProperty;var ti=Object.getOwnPropertyDescriptor;var ei=Object.getOwnPropertyNames;var ii=Object.prototype.hasOwnProperty;var ri=(i,e,t)=>e in i?Ht(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var si=(i,e)=>{for(var t in e)Ht(i,t,{get:e[t],enumerable:!0})},ni=(i,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of ei(e))!ii.call(i,a)&&a!==t&&Ht(i,a,{get:()=>e[a],enumerable:!(s=ti(e,a))||s.enumerable});return i};var ai=i=>ni(Ht({},"__esModule",{value:!0}),i);var m=(i,e,t)=>(ri(i,typeof e!="symbol"?e+"":e,t),t),oe=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var r=(i,e,t)=>(oe(i,e,"read from private field"),t?t.call(i):e.get(i)),c=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},d=(i,e,t,s)=>(oe(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t);var b=(i,e,t)=>(oe(i,e,"access private method"),t);var yi={};si(yi,{Attributes:()=>h,MediaError:()=>l.MediaError,VideoEvents:()=>Jt,default:()=>vi});module.exports=ai(yi);var dt=class{addEventListener(){}removeEventListener(){}dispatchEvent(e){return!0}};if(typeof DocumentFragment=="undefined"){class i extends dt{}globalThis.DocumentFragment=i}var Lt=class extends dt{},ce=class extends dt{},oi={get(i){},define(i,e,t){},upgrade(i){},whenDefined(i){return Promise.resolve(Lt)}},Ct,de=class{constructor(e,t={}){c(this,Ct,void 0);d(this,Ct,t==null?void 0:t.detail)}get detail(){return r(this,Ct)}initCustomEvent(){}};Ct=new WeakMap;function ci(i,e){return new Lt}var Ce={document:{createElement:ci},DocumentFragment,customElements:oi,CustomEvent:de,EventTarget:dt,HTMLElement:Lt,HTMLVideoElement:ce},Oe=typeof window=="undefined"||typeof globalThis.customElements=="undefined",Ot=Oe?Ce:globalThis,Ai=Oe?Ce.document:globalThis.document;var l=require("@mux/playback-core");var di=()=>{try{return"0.16.4"}catch{}return"UNKNOWN"},ui=di(),Ie=()=>ui;var we=i=>{var e,t,s,a,p,Me,T,$t,C,F,_,zt,at,Xt,Bt,_e,Ut,xe,ot,ue,f,k,P,g,y,L,w,It,Yt,De,St,he,Wt,Ne,Pt,le,jt,Fe,Rt,fe;return e=class extends i{constructor(){super();c(this,w);c(this,Yt);c(this,St);c(this,Wt);c(this,Pt);c(this,jt);c(this,Rt);m(this,"castEnabled",!1);c(this,f,{paused:!1});c(this,k,void 0);c(this,P,{});c(this,g,void 0);c(this,y,void 0);c(this,L,void 0);e.instances.add(this),b(this,Pt,le).call(this)}static get castElement(){return r(e,t)}static get castEnabled(){return r(e,s)}static get castState(){var n;return(n=r(e,C,F))==null?void 0:n.getCastState()}static async exitCast(){try{await r(e,C,F).endCurrentSession(!0)}catch(u){console.error(u);return}}get castPlayer(){if(e.castElement===this)return r(this,k)}attributeChangedCallback(n){if(!!this.castPlayer)switch(n){case"cast-stream-type":case"cast-src":this.load();break}}async requestCast(n={}){var u;b(u=e,ot,ue).call(u,n),d(e,t,this),Object.entries(r(this,P)).forEach(([S,O])=>{r(this,k).controller.addEventListener(S,O)});try{await r(e,C,F).requestSession()}catch{d(e,t,void 0);return}r(this,f).paused=super.paused,super.pause(),this.muted=super.muted;try{await this.load()}catch(S){console.error(S)}}async load(){var N,Z;if(!this.castPlayer)return super.load();let n=new chrome.cast.media.MediaInfo(this.castSrc,this.castContentType),u=[...this.querySelectorAll("track")].filter(({kind:x,src:M})=>M&&(x==="subtitles"||x==="captions")),S=[],O=0;u.length&&(n.tracks=u.map(x=>{let M=++O;S.length===0&&x.track.mode==="showing"&&S.push(M);let tt=new chrome.cast.media.Track(M,chrome.cast.media.TrackType.TEXT);return tt.trackContentId=x.src,tt.trackContentType="text/vtt",tt.subtype=x.kind==="captions"?chrome.cast.media.TextTrackType.CAPTIONS:chrome.cast.media.TextTrackType.SUBTITLES,tt.name=x.label,tt.language=x.srclang,tt})),this.castStreamType==="live"?n.streamType=chrome.cast.media.StreamType.LIVE:n.streamType=chrome.cast.media.StreamType.BUFFERED,n.metadata=new chrome.cast.media.GenericMediaMetadata,n.metadata.title=this.title,n.metadata.images=[{url:this.poster}];let I=new chrome.cast.media.LoadRequest(n);I.currentTime=(N=super.currentTime)!=null?N:0,I.autoplay=!r(this,f).paused,I.activeTrackIds=S,await((Z=r(e,_,zt))==null?void 0:Z.loadMedia(I)),this.dispatchEvent(new Event("volumechange"))}play(){var n;if(this.castPlayer){this.castPlayer.isPaused&&((n=this.castPlayer.controller)==null||n.playOrPause());return}return super.play()}pause(){var n;if(this.castPlayer){this.castPlayer.isPaused||(n=this.castPlayer.controller)==null||n.playOrPause();return}super.pause()}get castSrc(){var n,u,S;return(S=(u=this.getAttribute("cast-src"))!=null?u:(n=this.querySelector("source"))==null?void 0:n.src)!=null?S:this.currentSrc}set castSrc(n){this.castSrc!=n&&this.setAttribute("cast-src",`${n}`)}get castContentType(){var n;return(n=this.getAttribute("cast-content-type"))!=null?n:void 0}set castContentType(n){this.setAttribute("cast-content-type",`${n}`)}get castStreamType(){var n,u;return(u=(n=this.getAttribute("cast-stream-type"))!=null?n:this.streamType)!=null?u:void 0}set castStreamType(n){this.setAttribute("cast-stream-type",`${n}`)}get readyState(){if(this.castPlayer)switch(this.castPlayer.playerState){case chrome.cast.media.PlayerState.IDLE:return 0;case chrome.cast.media.PlayerState.BUFFERING:return 2;default:return 3}return super.readyState}get paused(){return this.castPlayer?this.castPlayer.isPaused:super.paused}get muted(){var n;return this.castPlayer?(n=this.castPlayer)==null?void 0:n.isMuted:super.muted}set muted(n){var u;if(this.castPlayer){(n&&!this.castPlayer.isMuted||!n&&this.castPlayer.isMuted)&&((u=this.castPlayer.controller)==null||u.muteOrUnmute());return}super.muted=n}get volume(){var n,u;return this.castPlayer?(u=(n=this.castPlayer)==null?void 0:n.volumeLevel)!=null?u:1:super.volume}set volume(n){var u;if(this.castPlayer){this.castPlayer.volumeLevel=n,(u=this.castPlayer.controller)==null||u.setVolumeLevel();return}super.volume=n}get duration(){var n,u;return this.castPlayer&&r(this,w,It)?(u=(n=this.castPlayer)==null?void 0:n.duration)!=null?u:NaN:super.duration}get currentTime(){var n,u;return this.castPlayer&&r(this,w,It)?(u=(n=this.castPlayer)==null?void 0:n.currentTime)!=null?u:0:super.currentTime}set currentTime(n){var u;if(this.castPlayer){this.castPlayer.currentTime=n,(u=this.castPlayer.controller)==null||u.seek();return}super.currentTime=n}get onentercast(){return r(this,g)}set onentercast(n){r(this,g)&&(this.removeEventListener("entercast",r(this,g)),d(this,g,null)),typeof n=="function"&&(d(this,g,n),this.addEventListener("entercast",n))}get onleavecast(){return r(this,y)}set onleavecast(n){r(this,y)&&(this.removeEventListener("leavecast",r(this,y)),d(this,y,null)),typeof n=="function"&&(d(this,y,n),this.addEventListener("leavecast",n))}get oncastchange(){return r(this,L)}set oncastchange(n){r(this,L)&&(this.removeEventListener("castchange",r(this,L)),d(this,L,null)),typeof n=="function"&&(d(this,L,n),this.addEventListener("castchange",n))}},t=new WeakMap,s=new WeakMap,a=new WeakMap,p=new WeakSet,Me=function(){return typeof chrome!="undefined"&&chrome.cast&&chrome.cast.isAvailable},T=new WeakSet,$t=function(){return typeof cast!="undefined"&&cast.framework},C=new WeakSet,F=function(){if(r(e,T,$t))return cast.framework.CastContext.getInstance()},_=new WeakSet,zt=function(){var n;return(n=r(e,C,F))==null?void 0:n.getCurrentSession()},at=new WeakSet,Xt=function(){var n;return(n=r(e,_,zt))==null?void 0:n.getSessionObj().media[0]},Bt=new WeakSet,_e=function(n){return new Promise((u,S)=>{r(e,at,Xt).editTracksInfo(n,u,S)})},Ut=new WeakSet,xe=function(n){return new Promise((u,S)=>{r(e,at,Xt).getStatus(n,u,S)})},ot=new WeakSet,ue=function(n){return r(e,C,F).setOptions({receiverApplicationId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,androidReceiverCompatible:!1,language:"en-US",resumeSavedSession:!0,...n})},f=new WeakMap,k=new WeakMap,P=new WeakMap,g=new WeakMap,y=new WeakMap,L=new WeakMap,w=new WeakSet,It=function(){var n;return(n=this.castPlayer)==null?void 0:n.isMediaLoaded},Yt=new WeakSet,De=function(){r(e,t)===this&&(Object.entries(r(this,P)).forEach(([n,u])=>{r(this,k).controller.removeEventListener(n,u)}),d(e,t,void 0),this.muted=r(this,k).isMuted,this.currentTime=r(this,k).savedPlayerState.currentTime,r(this,k).savedPlayerState.isPaused===!1&&this.play())},St=new WeakSet,he=function(){this.dispatchEvent(new CustomEvent("castchange",{detail:r(e,C,F).getCastState()}))},Wt=new WeakSet,Ne=async function(){var u,S;let{SESSION_RESUMED:n}=cast.framework.SessionState;if(r(e,C,F).getSessionState()===n&&this.castSrc===((u=r(e,at,Xt))==null?void 0:u.media.contentId)){d(e,t,this),Object.entries(r(this,P)).forEach(([O,I])=>{r(this,k).controller.addEventListener(O,I)});try{await b(S=e,Ut,xe).call(S,new chrome.cast.media.GetStatusRequest)}catch(O){console.error(O)}r(this,P)[cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED](),r(this,P)[cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED]()}},Pt=new WeakSet,le=function(){var n;!r(e,T,$t)||this.castEnabled||(this.castEnabled=!0,b(n=e,ot,ue).call(n),this.textTracks.addEventListener("change",b(this,Rt,fe).bind(this)),b(this,St,he).call(this),d(this,k,new cast.framework.RemotePlayer),new cast.framework.RemotePlayerController(r(this,k)),d(this,P,{[cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED]:({value:u})=>{u===!1&&b(this,Yt,De).call(this),this.dispatchEvent(new Event(u?"entercast":"leavecast"))},[cast.framework.RemotePlayerEventType.DURATION_CHANGED]:()=>{this.dispatchEvent(new Event("durationchange"))},[cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED]:()=>{this.dispatchEvent(new Event("volumechange"))},[cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED]:()=>{this.dispatchEvent(new Event("volumechange"))},[cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED]:()=>{!r(this,w,It)||this.dispatchEvent(new Event("timeupdate"))},[cast.framework.RemotePlayerEventType.VIDEO_INFO_CHANGED]:()=>{this.dispatchEvent(new Event("resize"))},[cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED]:()=>{this.dispatchEvent(new Event(this.paused?"pause":"play"))},[cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED]:()=>{var u,S;((u=this.castPlayer)==null?void 0:u.playerState)!==chrome.cast.media.PlayerState.PAUSED&&this.dispatchEvent(new Event({[chrome.cast.media.PlayerState.PLAYING]:"playing",[chrome.cast.media.PlayerState.BUFFERING]:"waiting",[chrome.cast.media.PlayerState.IDLE]:"emptied"}[(S=this.castPlayer)==null?void 0:S.playerState]))},[cast.framework.RemotePlayerEventType.IS_MEDIA_LOADED_CHANGED]:async()=>{!r(this,w,It)||(await Promise.resolve(),b(this,jt,Fe).call(this))}}))},jt=new WeakSet,Fe=function(){b(this,Rt,fe).call(this)},Rt=new WeakSet,fe=async function(){var ye,Te,be,Ae,ke,Se;if(!this.castPlayer)return;let u=((Te=(ye=r(this,k).mediaInfo)==null?void 0:ye.tracks)!=null?Te:[]).filter(({type:R})=>R===chrome.cast.media.TrackType.TEXT),S=[...this.textTracks].filter(({kind:R})=>R==="subtitles"||R==="captions"),O=u.map(({language:R,name:Kt,trackId:ae})=>{var Re;let{mode:Pe}=(Re=S.find(Le=>Le.language===R&&Le.label===Kt))!=null?Re:{};return Pe?{mode:Pe,trackId:ae}:!1}).filter(Boolean),N=O.filter(({mode:R})=>R!=="showing").map(({trackId:R})=>R),Z=O.find(({mode:R})=>R==="showing"),x=(ke=(Ae=(be=r(e,_,zt))==null?void 0:be.getSessionObj().media[0])==null?void 0:Ae.activeTrackIds)!=null?ke:[],M=x;if(x.length&&(M=M.filter(R=>!N.includes(R))),Z!=null&&Z.trackId&&(M=[...M,Z.trackId]),M=[...new Set(M)],!((R,Kt)=>R.length===Kt.length&&R.every(ae=>Kt.includes(ae)))(x,M))try{let R=new chrome.cast.media.EditTracksInfoRequest(M);await b(Se=e,Bt,_e).call(Se,R)}catch(R){console.error(R)}},c(e,p),c(e,T),c(e,C),c(e,_),c(e,at),c(e,Bt),c(e,Ut),c(e,ot),m(e,"observedAttributes",["cast-src","cast-content-type","cast-stream-type"]),m(e,"instances",new Set),c(e,t,void 0),c(e,s,!1),m(e,"initCast",()=>{var n;r(e,p,Me)?r(e,T,$t)?r(n=e,a).call(n,chrome.cast.isAvailable):customElements.whenDefined("google-cast-button").then(()=>{var u;return r(u=e,a).call(u,chrome.cast.isAvailable)}):globalThis.__onGCastApiAvailable=()=>{customElements.whenDefined("google-cast-button").then(()=>{var u;return r(u=e,a).call(u,chrome.cast.isAvailable)})}}),c(e,a,n=>{if(n){d(e,s,!0);let{CAST_STATE_CHANGED:u}=cast.framework.CastContextEventType;r(e,C,F).addEventListener(u,O=>{e.instances.forEach(I=>{var N;return b(N=I,St,he).call(N,O)})});let{SESSION_STATE_CHANGED:S}=cast.framework.CastContextEventType;r(e,C,F).addEventListener(S,O=>{e.instances.forEach(I=>{var N;return b(N=I,Wt,Ne).call(N,O)})}),e.instances.forEach(O=>{var I;return b(I=O,Pt,le).call(I)})}}),e},me=globalThis.HTMLVideoElement?we(HTMLVideoElement):we(Object);globalThis.customElements&&!globalThis.customElements.get("castable-video")&&(customElements.define("castable-video",me,{extends:"video"}),globalThis.CastableVideoElement=me);me.initCast();var Jt=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","waitingforkey","resize","enterpictureinpicture","leavepictureinpicture","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],Ge,pe=(Ge=globalThis.document)==null?void 0:Ge.createElement("template");pe&&(pe.innerHTML=`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      audio {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
      }
    </style>
    <slot></slot>
  `);var Ve,Ee=(Ve=globalThis.document)==null?void 0:Ve.createElement("template");Ee&&(Ee.innerHTML=`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      video {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, 50% 50%);
      }

      video::-webkit-media-text-track-container {
        transform: var(--media-webkit-text-track-transform);
        transition: var(--media-webkit-text-track-transition);
      }
    </style>
    <slot></slot>
  `);var Qt=(i,{tag:e,is:t})=>{var p,v,T,A,Be,kt,_,B,ut,Vt,qe,qt,Ue;let s=(p=globalThis.document)==null?void 0:p.createElement(e,{is:t}),a=s?hi(s):[];return v=class extends i{constructor(){super();c(this,B);c(this,Vt);c(this,qt);c(this,kt,void 0);c(this,_,void 0);this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.append(this.constructor.template.content.cloneNode(!0)))}static get observedAttributes(){var f,k,P;return b(f=v,A,Be).call(f),[...(P=(k=s==null?void 0:s.constructor)==null?void 0:k.observedAttributes)!=null?P:[],"autopictureinpicture","disablepictureinpicture","disableremoteplayback","autoplay","controls","controlslist","crossorigin","loop","muted","playsinline","poster","preload","src"]}get nativeEl(){var E,f;return(f=(E=r(this,_))!=null?E:this.shadowRoot.querySelector(e))!=null?f:this.querySelector(e)}set nativeEl(E){d(this,_,E)}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(E){this.toggleAttribute("muted",Boolean(E))}get src(){return this.getAttribute("src")}set src(E){this.setAttribute("src",`${E}`)}get preload(){var E,f;return(f=this.getAttribute("preload"))!=null?f:(E=this.nativeEl)==null?void 0:E.preload}set preload(E){this.setAttribute("preload",`${E}`)}attributeChangedCallback(E,f,k){b(this,B,ut).call(this),b(this,qt,Ue).call(this,E,f,k)}connectedCallback(){b(this,B,ut).call(this)}},T=new WeakMap,A=new WeakSet,Be=function(){if(r(this,T))return;d(this,T,!0);let E=new Set(this.observedAttributes);E.delete("muted");for(let f of a){if(f in this.prototype)continue;if(typeof s[f]=="function")this.prototype[f]=function(...P){return b(this,B,ut).call(this),(()=>this.call?this.call(f,...P):this.nativeEl[f].apply(this.nativeEl,P))()};else{let P={get(){var y,L,w;b(this,B,ut).call(this);let g=f.toLowerCase();if(E.has(g)){let ct=this.getAttribute(g);return ct===null?!1:ct===""?!0:ct}return(w=(y=this.get)==null?void 0:y.call(this,f))!=null?w:(L=this.nativeEl)==null?void 0:L[f]}};f!==f.toUpperCase()&&(P.set=function(g){b(this,B,ut).call(this);let y=f.toLowerCase();if(E.has(y)){g===!0||g===!1||g==null?this.toggleAttribute(y,Boolean(g)):this.setAttribute(y,g);return}if(this.set){this.set(f,g);return}this.nativeEl[f]=g}),Object.defineProperty(this.prototype,f,P)}}},kt=new WeakMap,_=new WeakMap,B=new WeakSet,ut=function(){var k,P;if(r(this,kt))return;if(d(this,kt,!0),!this.nativeEl){let g=document.createElement(e,{is:t});g.part=e,this.shadowRoot.append(g)}this.nativeEl.muted=this.hasAttribute("muted");for(let g of a)b(this,Vt,qe).call(this,g);let E=new Map,f=this.shadowRoot.querySelector("slot:not([name])");f==null||f.addEventListener("slotchange",()=>{let g=new Map(E);f.assignedElements().filter(y=>["track","source"].includes(y.localName)).forEach(y=>{var w,ct;g.delete(y);let L=E.get(y);L||(L=y.cloneNode(),E.set(y,L)),(ct=(w=this.nativeEl).append)==null||ct.call(w,L)}),g.forEach(y=>y.remove())});for(let g of this.constructor.Events)(P=(k=this.shadowRoot).addEventListener)==null||P.call(k,g,y=>{y.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(y.type,{detail:y.detail}))},!0)},Vt=new WeakSet,qe=function(E){if(Object.prototype.hasOwnProperty.call(this,E)){let f=this[E];delete this[E],this[E]=f}},qt=new WeakSet,Ue=function(E,f,k){var P,g,y,L;["id","class"].includes(E)||(k===null?(g=(P=this.nativeEl).removeAttribute)==null||g.call(P,E):(L=(y=this.nativeEl).setAttribute)==null||L.call(y,E,k))},c(v,A),m(v,"Events",Jt),m(v,"template",e.endsWith("audio")?pe:Ee),c(v,T,void 0),v};function hi(i){let e=[];for(let t=Object.getPrototypeOf(i);t&&t!==HTMLElement.prototype;t=Object.getPrototypeOf(t))e.push(...Object.getOwnPropertyNames(t));return e}var Ci=globalThis.document?Qt(HTMLElement,{tag:"video"}):class{},Oi=globalThis.document?Qt(HTMLElement,{tag:"audio"}):class{};var G=class extends Event{constructor(t,s){super(t);m(this,"track");this.track=s.track}};var ge=new WeakMap;function o(i){var e;return(e=ge.get(i))!=null?e:li(i,{})}function li(i,e){let t=ge.get(i);return t||ge.set(i,t={}),Object.assign(t,e)}function Zt(i,e){let t=i.videoTracks;o(e).media=i,o(e).renditionSet||(o(e).renditionSet=new Set);let s=o(t).trackSet;s.add(e);let a=s.size-1;a in it.prototype||Object.defineProperty(it.prototype,a,{get(){return[...o(this).trackSet][a]}}),queueMicrotask(()=>{t.dispatchEvent(new G("addtrack",{track:e}))})}function te(i){var s;let e=(s=o(i).media)==null?void 0:s.videoTracks;if(!e)return;o(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new G("removetrack",{track:i}))})}function Ye(i){var s;let e=(s=o(i).media.videoTracks)!=null?s:[],t=!1;for(let a of e)a!==i&&(a.selected=!1,t=!0);if(t){if(o(e).changeRequested)return;o(e).changeRequested=!0,queueMicrotask(()=>{delete o(e).changeRequested,e.dispatchEvent(new Event("change"))})}}var q,U,Y,et,wt,it=class extends EventTarget{constructor(){super();c(this,et);c(this,q,void 0);c(this,U,void 0);c(this,Y,void 0);o(this).trackSet=new Set}[Symbol.iterator](){return r(this,et,wt).values()}get length(){return r(this,et,wt).size}getTrackById(t){var s;return(s=[...r(this,et,wt)].find(a=>a.id===t))!=null?s:null}get selectedIndex(){return[...r(this,et,wt)].findIndex(t=>t.selected)}get onaddtrack(){return r(this,q)}set onaddtrack(t){r(this,q)&&(this.removeEventListener("addtrack",r(this,q)),d(this,q,void 0)),typeof t=="function"&&(d(this,q,t),this.addEventListener("addtrack",t))}get onremovetrack(){return r(this,U)}set onremovetrack(t){r(this,U)&&(this.removeEventListener("removetrack",r(this,U)),d(this,U,void 0)),typeof t=="function"&&(d(this,U,t),this.addEventListener("removetrack",t))}get onchange(){return r(this,Y)}set onchange(t){r(this,Y)&&(this.removeEventListener("change",r(this,Y)),d(this,Y,void 0)),typeof t=="function"&&(d(this,Y,t),this.addEventListener("change",t))}};q=new WeakMap,U=new WeakMap,Y=new WeakMap,et=new WeakSet,wt=function(){return o(this).trackSet};var V=class extends Event{constructor(t,s){super(t);m(this,"rendition");this.rendition=s.rendition}};function We(i,e){let t=o(i).media.videoRenditions;o(e).media=o(i).media,o(e).track=i;let s=o(i).renditionSet;s.add(e);let a=s.size-1;a in rt.prototype||Object.defineProperty(rt.prototype,a,{get(){return ht(this)[a]}}),queueMicrotask(()=>{!i.selected||t.dispatchEvent(new V("addrendition",{rendition:e}))})}function je(i){let e=o(i).media.videoRenditions,t=o(i).track;o(t).renditionSet.delete(i),queueMicrotask(()=>{!o(i).track.selected||e.dispatchEvent(new V("removerendition",{rendition:i}))})}function Ke(i){let e=o(i).media.videoRenditions;!e||o(e).changeRequested||(o(e).changeRequested=!0,queueMicrotask(()=>{delete o(e).changeRequested,o(i).track.selected&&e.dispatchEvent(new Event("change"))}))}function ht(i){return[...o(i).media.videoTracks].filter(t=>t.selected).flatMap(t=>[...o(t).renditionSet])}var W,j,K,rt=class extends EventTarget{constructor(){super(...arguments);c(this,W,void 0);c(this,j,void 0);c(this,K,void 0)}[Symbol.iterator](){return ht(this).values()}get length(){return ht(this).length}getRenditionById(t){var s;return(s=ht(this).find(a=>`${a.id}`==`${t}`))!=null?s:null}get selectedIndex(){return ht(this).findIndex(t=>t.selected)}set selectedIndex(t){for(let[s,a]of ht(this).entries())a.selected=s===t}get onaddrendition(){return r(this,W)}set onaddrendition(t){r(this,W)&&(this.removeEventListener("addrendition",r(this,W)),d(this,W,void 0)),typeof t=="function"&&(d(this,W,t),this.addEventListener("addrendition",t))}get onremoverendition(){return r(this,j)}set onremoverendition(t){r(this,j)&&(this.removeEventListener("removerendition",r(this,j)),d(this,j,void 0)),typeof t=="function"&&(d(this,j,t),this.addEventListener("removerendition",t))}get onchange(){return r(this,K)}set onchange(t){r(this,K)&&(this.removeEventListener("change",r(this,K)),d(this,K,void 0)),typeof t=="function"&&(d(this,K,t),this.addEventListener("change",t))}};W=new WeakMap,j=new WeakMap,K=new WeakMap;var lt,Mt=class{constructor(){m(this,"src");m(this,"id");m(this,"width");m(this,"height");m(this,"bitrate");m(this,"frameRate");m(this,"codec");c(this,lt,!1)}get selected(){return r(this,lt)}set selected(e){r(this,lt)!==e&&(d(this,lt,e),Ke(this))}};lt=new WeakMap;var ft,mt=class{constructor(){m(this,"id");m(this,"kind");m(this,"label","");m(this,"language","");m(this,"sourceBuffer");c(this,ft,!1)}addRendition(e,t,s,a,p,v){let T=new Mt;return T.src=e,T.width=t,T.height=s,T.frameRate=v,T.bitrate=p,T.codec=a,We(this,T),T}removeRendition(e){je(e)}get selected(){return r(this,ft)}set selected(e){r(this,ft)!==e&&(d(this,ft,e),e===!0&&Ye(this))}};ft=new WeakMap;function He(i,e){let t=o(i).media.audioRenditions;o(e).media=o(i).media,o(e).track=i;let s=o(i).renditionSet;s.add(e);let a=s.size-1;a in st.prototype||Object.defineProperty(st.prototype,a,{get(){return pt(this)[a]}}),queueMicrotask(()=>{!i.enabled||t.dispatchEvent(new V("addrendition",{rendition:e}))})}function $e(i){let e=o(i).media.audioRenditions,t=o(i).track;o(t).renditionSet.delete(i),queueMicrotask(()=>{!o(i).track.enabled||e.dispatchEvent(new V("removerendition",{rendition:i}))})}function ze(i){let e=o(i).media.audioRenditions;!e||o(e).changeRequested||(o(e).changeRequested=!0,queueMicrotask(()=>{delete o(e).changeRequested,o(i).track.enabled&&e.dispatchEvent(new Event("change"))}))}function pt(i){return[...o(i).media.audioTracks].filter(t=>t.enabled).flatMap(t=>[...o(t).renditionSet])}var H,$,z,st=class extends EventTarget{constructor(){super(...arguments);c(this,H,void 0);c(this,$,void 0);c(this,z,void 0)}[Symbol.iterator](){return pt(this).values()}get length(){return pt(this).length}getRenditionById(t){var s;return(s=pt(this).find(a=>`${a.id}`==`${t}`))!=null?s:null}get selectedIndex(){return pt(this).findIndex(t=>t.selected)}set selectedIndex(t){for(let[s,a]of pt(this).entries())a.selected=s===t}get onaddrendition(){return r(this,H)}set onaddrendition(t){r(this,H)&&(this.removeEventListener("addrendition",r(this,H)),d(this,H,void 0)),typeof t=="function"&&(d(this,H,t),this.addEventListener("addrendition",t))}get onremoverendition(){return r(this,$)}set onremoverendition(t){r(this,$)&&(this.removeEventListener("removerendition",r(this,$)),d(this,$,void 0)),typeof t=="function"&&(d(this,$,t),this.addEventListener("removerendition",t))}get onchange(){return r(this,z)}set onchange(t){r(this,z)&&(this.removeEventListener("change",r(this,z)),d(this,z,void 0)),typeof t=="function"&&(d(this,z,t),this.addEventListener("change",t))}};H=new WeakMap,$=new WeakMap,z=new WeakMap;var Et,_t=class{constructor(){m(this,"src");m(this,"id");m(this,"bitrate");m(this,"codec");c(this,Et,!1)}get selected(){return r(this,Et)}set selected(e){r(this,Et)!==e&&(d(this,Et,e),ze(this))}};Et=new WeakMap;function ie(i,e){let t=i.audioTracks;o(e).media=i,o(e).renditionSet||(o(e).renditionSet=new Set);let s=o(t).trackSet;s.add(e);let a=s.size-1;a in nt.prototype||Object.defineProperty(nt.prototype,a,{get(){return[...o(this).trackSet][a]}}),queueMicrotask(()=>{t.dispatchEvent(new G("addtrack",{track:e}))})}function re(i){var s;let e=(s=o(i).media)==null?void 0:s.audioTracks;if(!e)return;o(e).trackSet.delete(i),queueMicrotask(()=>{e.dispatchEvent(new G("removetrack",{track:i}))})}function Xe(i){let e=o(i).media.audioTracks;!e||o(e).changeRequested||(o(e).changeRequested=!0,queueMicrotask(()=>{delete o(e).changeRequested,e.dispatchEvent(new Event("change"))}))}var X,J,Q,gt,ee,nt=class extends EventTarget{constructor(){super();c(this,gt);c(this,X,void 0);c(this,J,void 0);c(this,Q,void 0);o(this).trackSet=new Set}[Symbol.iterator](){return r(this,gt,ee).values()}get length(){return r(this,gt,ee).size}getTrackById(t){var s;return(s=[...r(this,gt,ee)].find(a=>a.id===t))!=null?s:null}get onaddtrack(){return r(this,X)}set onaddtrack(t){r(this,X)&&(this.removeEventListener("addtrack",r(this,X)),d(this,X,void 0)),typeof t=="function"&&(d(this,X,t),this.addEventListener("addtrack",t))}get onremovetrack(){return r(this,J)}set onremovetrack(t){r(this,J)&&(this.removeEventListener("removetrack",r(this,J)),d(this,J,void 0)),typeof t=="function"&&(d(this,J,t),this.addEventListener("removetrack",t))}get onchange(){return r(this,Q)}set onchange(t){r(this,Q)&&(this.removeEventListener("change",r(this,Q)),d(this,Q,void 0)),typeof t=="function"&&(d(this,Q,t),this.addEventListener("change",t))}};X=new WeakMap,J=new WeakMap,Q=new WeakMap,gt=new WeakSet,ee=function(){return o(this).trackSet};var vt,yt=class{constructor(){m(this,"id");m(this,"kind");m(this,"label","");m(this,"language","");m(this,"sourceBuffer");c(this,vt,!1)}addRendition(e,t,s){let a=new _t;return a.src=e,a.codec=t,a.bitrate=s,He(this,a),a}removeRendition(e){$e(e)}get enabled(){return r(this,vt)}set enabled(e){r(this,vt)!==e&&(d(this,vt,e),Xe(this))}};vt=new WeakMap;var Je=se(globalThis.HTMLMediaElement,"video"),Qe=se(globalThis.HTMLMediaElement,"audio");function Ze(i){if(!(i!=null&&i.prototype))return i;let e=se(i,"video");(!e||`${e}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"videoTracks",{get(){return fi(this)}});let t=se(i,"audio");(!t||`${t}`.includes("[native code]"))&&Object.defineProperty(i.prototype,"audioTracks",{get(){return mi(this)}}),"addVideoTrack"in i.prototype||(i.prototype.addVideoTrack=function(p,v="",T=""){let A=new mt;return A.kind=p,A.label=v,A.language=T,Zt(this,A),A}),"removeVideoTrack"in i.prototype||(i.prototype.removeVideoTrack=te),"addAudioTrack"in i.prototype||(i.prototype.addAudioTrack=function(p,v="",T=""){let A=new yt;return A.kind=p,A.label=v,A.language=T,ie(this,A),A}),"removeAudioTrack"in i.prototype||(i.prototype.removeAudioTrack=re),"videoRenditions"in i.prototype||Object.defineProperty(i.prototype,"videoRenditions",{get(){return s(this)}});let s=p=>{let v=o(p).videoRenditions;return v||(v=new rt,o(v).media=p,o(p).videoRenditions=v),v};"audioRenditions"in i.prototype||Object.defineProperty(i.prototype,"audioRenditions",{get(){return a(this)}});let a=p=>{let v=o(p).audioRenditions;return v||(v=new st,o(v).media=p,o(p).audioRenditions=v),v};return i}function se(i,e){var t;if(i!=null&&i.prototype)return(t=Object.getOwnPropertyDescriptor(i.prototype,`${e}Tracks`))==null?void 0:t.get}function fi(i){var t;let e=o(i).videoTracks;if(!e&&(e=new it,o(i).videoTracks=e,Je)){let s=Je.call((t=i.nativeEl)!=null?t:i);for(let a of s)Zt(i,a);s.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),s.addEventListener("addtrack",a=>{if([...e].some(p=>p instanceof mt)){for(let p of s)te(p);return}Zt(i,a.track)}),s.addEventListener("removetrack",a=>{te(a.track)})}return e}function mi(i){var t;let e=o(i).audioTracks;if(!e&&(e=new nt,o(i).audioTracks=e,Qe)){let s=Qe.call((t=i.nativeEl)!=null?t:i);for(let a of s)ie(i,a);s.addEventListener("change",()=>{e.dispatchEvent(new Event("change"))}),s.addEventListener("addtrack",a=>{if([...e].some(p=>p instanceof yt)){for(let p of s)re(p);return}ie(i,a.track)}),s.addEventListener("removetrack",a=>{re(a.track)})}return e}Jt.push("castchange","entercast","leavecast");var ve=Ze(Qt(Ot.HTMLElement,{tag:"video",is:"castable-video"})),h={BEACON_COLLECTION_DOMAIN:"beacon-collection-domain",CUSTOM_DOMAIN:"custom-domain",DEBUG:"debug",DISABLE_COOKIES:"disable-cookies",ENV_KEY:"env-key",MAX_RESOLUTION:"max-resolution",METADATA_URL:"metadata-url",PLAYBACK_ID:"playback-id",PLAYER_SOFTWARE_NAME:"player-software-name",PLAYER_SOFTWARE_VERSION:"player-software-version",PREFER_CMCD:"prefer-cmcd",PREFER_PLAYBACK:"prefer-playback",START_TIME:"start-time",STREAM_TYPE:"stream-type",TARGET_LIVE_WINDOW:"target-live-window",LIVE_EDGE_OFFSET:"live-edge-offset",TYPE:"type"},pi=Object.values(h),Ei=Ie(),gi="mux-video",D,Tt,Dt,bt,Nt,Ft,Gt,At,ne,xt=class extends ve{constructor(){super();c(this,At);c(this,D,void 0);c(this,Tt,void 0);c(this,Dt,void 0);c(this,bt,{});c(this,Nt,void 0);c(this,Ft,void 0);c(this,Gt,void 0);d(this,Dt,(0,l.generatePlayerInitTime)())}static get observedAttributes(){var t;return[...pi,...(t=ve.observedAttributes)!=null?t:[]]}get preferCmcd(){var t;return(t=this.getAttribute(h.PREFER_CMCD))!=null?t:void 0}set preferCmcd(t){t!==this.preferCmcd&&(t?l.CmcdTypeValues.includes(t)?this.setAttribute(h.PREFER_CMCD,t):console.warn(`Invalid value for preferCmcd. Must be one of ${l.CmcdTypeValues.join()}`):this.removeAttribute(h.PREFER_CMCD))}get playerInitTime(){return r(this,Dt)}get playerSoftwareName(){var t;return(t=r(this,Ft))!=null?t:gi}set playerSoftwareName(t){d(this,Ft,t)}get playerSoftwareVersion(){var t;return(t=r(this,Nt))!=null?t:Ei}set playerSoftwareVersion(t){d(this,Nt,t)}get _hls(){var t;return(t=r(this,D))==null?void 0:t.engine}get mux(){var t;return(t=this.nativeEl)==null?void 0:t.mux}get error(){var t;return(t=(0,l.getError)(this.nativeEl))!=null?t:null}get errorTranslator(){return r(this,Gt)}set errorTranslator(t){d(this,Gt,t)}get src(){return this.getAttribute("src")}set src(t){t!==this.src&&(t==null?this.removeAttribute("src"):this.setAttribute("src",t))}get type(){var t;return(t=this.getAttribute(h.TYPE))!=null?t:void 0}set type(t){t!==this.type&&(t?this.setAttribute(h.TYPE,t):this.removeAttribute(h.TYPE))}get autoplay(){let t=this.getAttribute("autoplay");return t===null?!1:t===""?!0:t}set autoplay(t){let s=this.autoplay;t!==s&&(t?this.setAttribute("autoplay",typeof t=="string"?t:""):this.removeAttribute("autoplay"))}get preload(){let t=this.getAttribute("preload");return t===""?"auto":["none","metadata","auto"].includes(t)?t:super.preload}set preload(t){t!=this.getAttribute("preload")&&(["","none","metadata","auto"].includes(t)?this.setAttribute("preload",t):this.removeAttribute("preload"))}get debug(){return this.getAttribute(h.DEBUG)!=null}set debug(t){t!==this.debug&&(t?this.setAttribute(h.DEBUG,""):this.removeAttribute(h.DEBUG))}get disableCookies(){return this.hasAttribute(h.DISABLE_COOKIES)}set disableCookies(t){t!==this.disableCookies&&(t?this.setAttribute(h.DISABLE_COOKIES,""):this.removeAttribute(h.DISABLE_COOKIES))}get startTime(){let t=this.getAttribute(h.START_TIME);if(t==null)return;let s=+t;return Number.isNaN(s)?void 0:s}set startTime(t){t!==this.startTime&&(t==null?this.removeAttribute(h.START_TIME):this.setAttribute(h.START_TIME,`${t}`))}get playbackId(){var t;return(t=this.getAttribute(h.PLAYBACK_ID))!=null?t:void 0}set playbackId(t){t!==this.playbackId&&(t?this.setAttribute(h.PLAYBACK_ID,t):this.removeAttribute(h.PLAYBACK_ID))}get maxResolution(){var t;return(t=this.getAttribute(h.MAX_RESOLUTION))!=null?t:void 0}set maxResolution(t){t!==this.maxResolution&&(t?this.setAttribute(h.MAX_RESOLUTION,t):this.removeAttribute(h.MAX_RESOLUTION))}get customDomain(){var t;return(t=this.getAttribute(h.CUSTOM_DOMAIN))!=null?t:void 0}set customDomain(t){t!==this.customDomain&&(t?this.setAttribute(h.CUSTOM_DOMAIN,t):this.removeAttribute(h.CUSTOM_DOMAIN))}get ended(){return(0,l.getEnded)(this.nativeEl,this._hls)}get envKey(){var t;return(t=this.getAttribute(h.ENV_KEY))!=null?t:void 0}set envKey(t){t!==this.envKey&&(t?this.setAttribute(h.ENV_KEY,t):this.removeAttribute(h.ENV_KEY))}get beaconCollectionDomain(){var t;return(t=this.getAttribute(h.BEACON_COLLECTION_DOMAIN))!=null?t:void 0}set beaconCollectionDomain(t){t!==this.beaconCollectionDomain&&(t?this.setAttribute(h.BEACON_COLLECTION_DOMAIN,t):this.removeAttribute(h.BEACON_COLLECTION_DOMAIN))}get streamType(){var t;return(t=this.getAttribute(h.STREAM_TYPE))!=null?t:(0,l.getStreamType)(this.nativeEl)}set streamType(t){t!==this.streamType&&(t?this.setAttribute(h.STREAM_TYPE,t):this.removeAttribute(h.STREAM_TYPE))}get targetLiveWindow(){return this.hasAttribute(h.TARGET_LIVE_WINDOW)?+this.getAttribute(h.TARGET_LIVE_WINDOW):(0,l.getTargetLiveWindow)(this.nativeEl)}set targetLiveWindow(t){t!=this.targetLiveWindow&&(t==null?this.removeAttribute(h.TARGET_LIVE_WINDOW):this.setAttribute(h.TARGET_LIVE_WINDOW,`${+t}`))}get liveEdgeStart(){var t,s;if(this.hasAttribute(h.LIVE_EDGE_OFFSET)){let{liveEdgeOffset:a}=this,p=(t=this.nativeEl.seekable.end(0))!=null?t:0,v=(s=this.nativeEl.seekable.start(0))!=null?s:0;return Math.max(v,p-a)}return(0,l.getLiveEdgeStart)(this.nativeEl)}get liveEdgeOffset(){if(!!this.hasAttribute(h.LIVE_EDGE_OFFSET))return+this.getAttribute(h.LIVE_EDGE_OFFSET)}set liveEdgeOffset(t){t!=this.targetLiveWindow&&(t==null?this.removeAttribute(h.LIVE_EDGE_OFFSET):this.setAttribute(h.LIVE_EDGE_OFFSET,`${+t}`))}get seekable(){return(0,l.getSeekable)(this.nativeEl)}async addCuePoints(t){return(0,l.addCuePoints)(this.nativeEl,t)}get activeCuePoint(){return(0,l.getActiveCuePoint)(this.nativeEl)}get cuePoints(){return(0,l.getCuePoints)(this.nativeEl)}getStartDate(){return(0,l.getStartDate)(this.nativeEl,this._hls)}get currentPdt(){return(0,l.getCurrentPdt)(this.nativeEl,this._hls)}get preferPlayback(){let t=this.getAttribute(h.PREFER_PLAYBACK);if(t===l.PlaybackTypes.MSE||t===l.PlaybackTypes.NATIVE)return t}set preferPlayback(t){t!==this.preferPlayback&&(t===l.PlaybackTypes.MSE||t===l.PlaybackTypes.NATIVE?this.setAttribute(h.PREFER_PLAYBACK,t):this.removeAttribute(h.PREFER_PLAYBACK))}get metadata(){return{...this.getAttributeNames().filter(s=>s.startsWith("metadata-")&&![h.METADATA_URL].includes(s)).reduce((s,a)=>{let p=this.getAttribute(a);return p!=null&&(s[a.replace(/^metadata-/,"").replace(/-/g,"_")]=p),s},{}),...r(this,bt)}}set metadata(t){d(this,bt,t!=null?t:{}),this.mux&&this.mux.emit("hb",r(this,bt))}load(){d(this,D,(0,l.initialize)(this,this.nativeEl,r(this,D)))}unload(){(0,l.teardown)(this.nativeEl,r(this,D)),d(this,D,void 0)}attributeChangedCallback(t,s,a){var v,T;switch(ve.observedAttributes.includes(t)&&!["src","autoplay","preload"].includes(t)&&super.attributeChangedCallback(t,s,a),t){case h.PLAYER_SOFTWARE_NAME:this.playerSoftwareName=a!=null?a:void 0;break;case h.PLAYER_SOFTWARE_VERSION:this.playerSoftwareVersion=a!=null?a:void 0;break;case"src":{let A=!!s,C=!!a;!A&&C?b(this,At,ne).call(this):A&&!C?this.unload():A&&C&&(this.unload(),b(this,At,ne).call(this));break}case"autoplay":if(a===s)break;(v=r(this,D))==null||v.setAutoplay(this.autoplay);break;case"preload":if(a===s)break;(T=r(this,D))==null||T.setPreload(a);break;case h.PLAYBACK_ID:this.src=(0,l.toMuxVideoURL)(a!=null?a:void 0,{maxResolution:this.maxResolution,domain:this.customDomain});break;case h.DEBUG:{let A=this.debug;this.mux&&console.info("Cannot toggle debug mode of mux data after initialization. Make sure you set all metadata to override before setting the src."),this._hls&&(this._hls.config.debug=A);break}case h.METADATA_URL:a&&fetch(a).then(A=>A.json()).then(A=>this.metadata=A).catch(()=>console.error(`Unable to load or parse metadata JSON from metadata-url ${a}!`));break;case h.STREAM_TYPE:(a==null||a!==s)&&this.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}));break;case h.TARGET_LIVE_WINDOW:(a==null||a!==s)&&this.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0,detail:this.targetLiveWindow}));break;default:break}}connectedCallback(){var t;(t=super.connectedCallback)==null||t.call(this),this.nativeEl&&this.src&&!r(this,D)&&b(this,At,ne).call(this)}disconnectedCallback(){this.unload()}};D=new WeakMap,Tt=new WeakMap,Dt=new WeakMap,bt=new WeakMap,Nt=new WeakMap,Ft=new WeakMap,Gt=new WeakMap,At=new WeakSet,ne=async function(){r(this,Tt)||(await d(this,Tt,Promise.resolve()),d(this,Tt,null),this.load())};Ot.customElements.get("mux-video")||(Ot.customElements.define("mux-video",xt),Ot.MuxVideoElement=xt);var vi=xt;
//# sourceMappingURL=index.cjs.js.map
